this is merged result between hotfix and iss533

